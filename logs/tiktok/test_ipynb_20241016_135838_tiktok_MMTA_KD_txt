2024-10-16 13:58: PID: 25771

2024-10-16 13:58: args: 
name                              : MMTA_KD
dataset                           : tiktok
data_path                         : /home/ZIYIAP/Documents/OneDrive_local/distiller/TARec/TARec/data
Ks                                : [10, 20, 40, 50]
seed                              : 14322
sparse                            : 1
test_flag                         : part
edge_mask                         : 0
edge_mask_rate                    : 0.1
batch_size                        : 1024
epoch                             : 1000
cf_model                          : light_init
early_stopping_patience           : 8
gpu_id                            : 0
regs                              : [1e-5,1e-5,1e-2]
emb_reg                           : 1e-07
teacher_model_type                : gcl
lr                                : 0.001
teacher_model_dict_name           : teacher_model_great
teacher_reg_rate                  : 1
t_weight_decay                    : 0.001
t_feat_mf_rate                    : 0.001
feat_reg_decay                    : 1e-05
is_softmax                        : True
is_gcl_softmax                    : False
teacher_assistant_model_type      : lightgcl
teacher_assistant_model_dict_name : teacher_assistant_model_great
student_model_type                : mlpgcl
student_model_dict_name           : 
student_embed_size                : 64
student_lr                        : 0.001
student_reg_rate                  : 1
student_drop_rate                 : 0.2
student_tau                       : 5
embed_size                        : 64
drop_rate                         : 0.4
weight_size                       : [64, 64]
model_cat_rate                    : 0.028
layers                            : 1
n_layers                          : 2
ta_n_layers                       : 1
student_n_layers                  : 1
mlp_n_layers                      : 1
if_train_teacher                  : True
is_train_student                  : False
kd_loss_rate                      : 5e-06
kd_loss_feat_rate                 : 0.1
cl_loss_rate                      : 0.002
svd_gcl_rate                      : 1.0
x_gcl_rate                        : 1.0
layer_gcl                         : 1.0
svd_layer_gcl                     : 0.0
xsvd_gcl                          : 0.0
x_layer_gcl                       : 0.0
ssm_rate                          : 0.6
s_layer_gcl                       : 0.0025
t_cl_loss_rate                    : 0.01
hard_token_type                   : pca
soft_token_rate                   : 0.1
feat_soft_token_rate              : 9
t_prompt_rate1                    : 100.0
prompt_dropout                    : 0
alpha_l                           : 2
feat_loss_type                    : sce
neg_sample_num                    : 10
list_wise_loss_rate               : 1
q                                 : 1
eps                               : 0.2
kd_t_decay_threshold              : 0.0
kd_ta_decay_rate                  : 0.6
kd_t_decay_rate                   : 0.6
t_init_method                     : uniform
norm_mode                         : None
ta_norm_mode                      : None
s_norm_mode                       : None
s_norm_scale                      : 0.05
ta_norm_scale                     : 0.0
norm_scale                        : 0.08
kd_loss_type                      : sinkhorn
is_teacher_kd                     : False
init_teacher                      : False
t_bpr_loss_rate                   : 1.0
2024-10-16 13:58: 🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸
2024-10-16 13:58: 🎓📘 Start training teacher model... 🚀✨
2024-10-16 13:58: Teacher model type: gcl
2024-10-16 13:58: 🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸

2024-10-16 13:58: 🎓📘Epoch 1/1000 Early stopping 0 - Recall 0.05167, Ndcg: 0.0198 || Avg Loss: 38.7785 | BPR: 0.6612, Prompt: 0.3750, Image: 76.6658, Text: 7.5182, Reg: 0.0000, Feat_Reg: 0.0447, GCL: 0.4919
2024-10-16 13:59: 🎓📘Epoch 2/1000 Early stopping 0 - Recall 0.04181, Ndcg: 0.0155 || Avg Loss: 27.4581 | BPR: 0.5682, Prompt: 0.2642, Image: 4.6063, Text: 0.4717, Reg: 0.0000, Feat_Reg: 0.0104, GCL: 0.4556
2024-10-16 13:59: 🎓📘Epoch 3/1000 Early stopping 0 - Recall 0.04625, Ndcg: 0.0171 || Avg Loss: 25.7298 | BPR: 0.3924, Prompt: 0.2486, Image: 3.3653, Text: 0.8606, Reg: 0.0001, Feat_Reg: 0.0092, GCL: 0.4640
2024-10-16 13:59: 🎓📘Epoch 4/1000 Early stopping 0 - Recall 0.05319, Ndcg: 0.0194 || Avg Loss: 25.0996 | BPR: 0.2857, Prompt: 0.2435, Image: 2.7745, Text: 0.9441, Reg: 0.0001, Feat_Reg: 0.0084, GCL: 0.4555
2024-10-16 13:59: 🎓📘Epoch 5/1000 Early stopping 0 - Recall 0.05861, Ndcg: 0.0215 || Avg Loss: 24.8578 | BPR: 0.2265, Prompt: 0.2417, Image: 2.6168, Text: 0.9018, Reg: 0.0002, Feat_Reg: 0.0077, GCL: 0.4463
2024-10-16 14:00: 🎓📘Epoch 6/1000 Early stopping 0 - Recall 0.06306, Ndcg: 0.0231 || Avg Loss: 24.6783 | BPR: 0.1864, Prompt: 0.2404, Image: 2.4739, Text: 1.0235, Reg: 0.0002, Feat_Reg: 0.0074, GCL: 0.4383
2024-10-16 14:00: 🎓📘Epoch 7/1000 Early stopping 0 - Recall 0.06861, Ndcg: 0.0249 || Avg Loss: 24.5959 | BPR: 0.1586, Prompt: 0.2400, Image: 2.3711, Text: 1.0382, Reg: 0.0002, Feat_Reg: 0.0070, GCL: 0.4306
2024-10-16 14:00: 🎓📘Epoch 8/1000 Early stopping 0 - Recall 0.07167, Ndcg: 0.0261 || Avg Loss: 24.5749 | BPR: 0.1365, Prompt: 0.2400, Image: 2.1833, Text: 1.0219, Reg: 0.0002, Feat_Reg: 0.0066, GCL: 0.4251
2024-10-16 14:00: 🎉Best recall: [0.03750, 0.07403, 0.12694, 0.15125], Best ndcg: [0.01757, 0.02670, 0.03746, 0.04185]. Model saved to teacher_model_great.pt
2024-10-16 14:00: 🎓📘Epoch 9/1000 Early stopping 0 - Recall 0.07403, Ndcg: 0.0267 || Avg Loss: 24.6564 | BPR: 0.1196, Prompt: 0.2410, Image: 2.1594, Text: 1.2114, Reg: 0.0003, Feat_Reg: 0.0064, GCL: 0.4227
2024-10-16 14:00: 🎉Best recall: [0.03819, 0.07542, 0.13125, 0.15542], Best ndcg: [0.01805, 0.02733, 0.03867, 0.04303]. Model saved to teacher_model_great.pt
2024-10-16 14:00: 🎓📘Epoch 10/1000 Early stopping 0 - Recall 0.07542, Ndcg: 0.0273 || Avg Loss: 24.5685 | BPR: 0.1052, Prompt: 0.2404, Image: 2.3166, Text: 1.0731, Reg: 0.0003, Feat_Reg: 0.0063, GCL: 0.4153
2024-10-16 14:01: 🎉Best recall: [0.03847, 0.07653, 0.13278, 0.15611], Best ndcg: [0.01835, 0.02789, 0.03931, 0.04353]. Model saved to teacher_model_great.pt
2024-10-16 14:01: 🎓📘Epoch 11/1000 Early stopping 0 - Recall 0.07653, Ndcg: 0.0279 || Avg Loss: 24.5446 | BPR: 0.0933, Prompt: 0.2403, Image: 2.0493, Text: 0.7973, Reg: 0.0003, Feat_Reg: 0.0058, GCL: 0.4119
2024-10-16 14:01: 🎉Best recall: [0.03917, 0.07903, 0.13306, 0.15972], Best ndcg: [0.01852, 0.02847, 0.03945, 0.04427]. Model saved to teacher_model_great.pt
2024-10-16 14:01: 🎓📘Epoch 12/1000 Early stopping 0 - Recall 0.07903, Ndcg: 0.0285 || Avg Loss: 24.5966 | BPR: 0.0838, Prompt: 0.2409, Image: 2.2698, Text: 0.7668, Reg: 0.0003, Feat_Reg: 0.0057, GCL: 0.4088
2024-10-16 14:01: 🎉Best recall: [0.04083, 0.07944, 0.13569, 0.16097], Best ndcg: [0.01933, 0.02894, 0.04038, 0.04495]. Model saved to teacher_model_great.pt
2024-10-16 14:01: 🎓📘Epoch 13/1000 Early stopping 0 - Recall 0.07944, Ndcg: 0.0289 || Avg Loss: 24.4344 | BPR: 0.0752, Prompt: 0.2395, Image: 1.8611, Text: 0.6250, Reg: 0.0003, Feat_Reg: 0.0052, GCL: 0.4060
2024-10-16 14:01: 🎉Best recall: [0.04153, 0.08083, 0.13722, 0.16444], Best ndcg: [0.01952, 0.02930, 0.04076, 0.04568]. Model saved to teacher_model_great.pt
2024-10-16 14:01: 🎓📘Epoch 14/1000 Early stopping 0 - Recall 0.08083, Ndcg: 0.0293 || Avg Loss: 24.5434 | BPR: 0.0687, Prompt: 0.2406, Image: 1.8786, Text: 0.6953, Reg: 0.0004, Feat_Reg: 0.0051, GCL: 0.4037
2024-10-16 14:01: 🎉Best recall: [0.04153, 0.07986, 0.13847, 0.16778], Best ndcg: [0.01947, 0.02905, 0.04098, 0.04628]. Model saved to teacher_model_great.pt
2024-10-16 14:01: 🎓📘Epoch 15/1000 Early stopping 0 - Recall 0.07986, Ndcg: 0.0290 || Avg Loss: 24.3843 | BPR: 0.0624, Prompt: 0.2391, Image: 1.9232, Text: 0.5066, Reg: 0.0004, Feat_Reg: 0.0048, GCL: 0.4008
2024-10-16 14:02: 🎉Best recall: [0.04153, 0.08208, 0.14139, 0.16917], Best ndcg: [0.01994, 0.03010, 0.04216, 0.04717]. Model saved to teacher_model_great.pt
2024-10-16 14:02: 🎓📘Epoch 16/1000 Early stopping 0 - Recall 0.08208, Ndcg: 0.0301 || Avg Loss: 24.3260 | BPR: 0.0558, Prompt: 0.2386, Image: 1.6588, Text: 0.4247, Reg: 0.0004, Feat_Reg: 0.0045, GCL: 0.3986
2024-10-16 14:02: 🎓📘Epoch 17/1000 Early stopping 1 - Recall 0.08208, Ndcg: 0.0301 || Avg Loss: 24.5410 | BPR: 0.0512, Prompt: 0.2409, Image: 1.6847, Text: 0.4253, Reg: 0.0004, Feat_Reg: 0.0043, GCL: 0.3974
2024-10-16 14:02: 🎉Best recall: [0.04347, 0.08292, 0.14417, 0.17097], Best ndcg: [0.02053, 0.03040, 0.04284, 0.04768]. Model saved to teacher_model_great.pt
2024-10-16 14:02: 🎓📘Epoch 18/1000 Early stopping 0 - Recall 0.08292, Ndcg: 0.0304 || Avg Loss: 24.3674 | BPR: 0.0467, Prompt: 0.2392, Image: 1.5001, Text: 0.4574, Reg: 0.0004, Feat_Reg: 0.0040, GCL: 0.3956
2024-10-16 14:02: 🎉Best recall: [0.04347, 0.08347, 0.14444, 0.17000], Best ndcg: [0.02069, 0.03072, 0.04311, 0.04773]. Model saved to teacher_model_great.pt
2024-10-16 14:02: 🎓📘Epoch 19/1000 Early stopping 0 - Recall 0.08347, Ndcg: 0.0307 || Avg Loss: 24.4960 | BPR: 0.0426, Prompt: 0.2405, Image: 1.5824, Text: 0.5146, Reg: 0.0004, Feat_Reg: 0.0040, GCL: 0.3934
2024-10-16 14:03: 🎉Best recall: [0.04375, 0.08486, 0.14597, 0.17194], Best ndcg: [0.02095, 0.03128, 0.04367, 0.04837]. Model saved to teacher_model_great.pt
2024-10-16 14:03: 🎓📘Epoch 20/1000 Early stopping 0 - Recall 0.08486, Ndcg: 0.0313 || Avg Loss: 24.6973 | BPR: 0.0391, Prompt: 0.2426, Image: 1.4622, Text: 0.4344, Reg: 0.0005, Feat_Reg: 0.0038, GCL: 0.3935
2024-10-16 14:03: 🎉Best recall: [0.04444, 0.08500, 0.14778, 0.17278], Best ndcg: [0.02136, 0.03154, 0.04427, 0.04879]. Model saved to teacher_model_great.pt
2024-10-16 14:03: 🎓📘Epoch 21/1000 Early stopping 0 - Recall 0.08500, Ndcg: 0.0315 || Avg Loss: 24.4391 | BPR: 0.0364, Prompt: 0.2401, Image: 1.4053, Text: 0.5550, Reg: 0.0005, Feat_Reg: 0.0037, GCL: 0.3908
2024-10-16 14:03: 🎓📘Epoch 22/1000 Early stopping 1 - Recall 0.08403, Ndcg: 0.0316 || Avg Loss: 24.4029 | BPR: 0.0331, Prompt: 0.2397, Image: 1.3141, Text: 0.4311, Reg: 0.0005, Feat_Reg: 0.0035, GCL: 0.3897
2024-10-16 14:03: 🎉Best recall: [0.04569, 0.08528, 0.14708, 0.17458], Best ndcg: [0.02219, 0.03206, 0.04463, 0.04961]. Model saved to teacher_model_great.pt
2024-10-16 14:03: 🎓📘Epoch 23/1000 Early stopping 0 - Recall 0.08528, Ndcg: 0.0321 || Avg Loss: 24.3278 | BPR: 0.0313, Prompt: 0.2390, Image: 1.2669, Text: 0.5385, Reg: 0.0005, Feat_Reg: 0.0034, GCL: 0.3881
2024-10-16 14:03: 🎓📘Epoch 24/1000 Early stopping 1 - Recall 0.08375, Ndcg: 0.0317 || Avg Loss: 24.3653 | BPR: 0.0292, Prompt: 0.2394, Image: 1.4675, Text: 0.4746, Reg: 0.0005, Feat_Reg: 0.0034, GCL: 0.3882
2024-10-16 14:04: 🎉Best recall: [0.04653, 0.08472, 0.14806, 0.17403], Best ndcg: [0.02267, 0.03224, 0.04512, 0.04982]. Model saved to teacher_model_great.pt
2024-10-16 14:04: 🎓📘Epoch 25/1000 Early stopping 0 - Recall 0.08472, Ndcg: 0.0322 || Avg Loss: 24.3564 | BPR: 0.0273, Prompt: 0.2394, Image: 1.1964, Text: 0.5163, Reg: 0.0005, Feat_Reg: 0.0031, GCL: 0.3864
2024-10-16 14:04: 🎓📘Epoch 26/1000 Early stopping 1 - Recall 0.08417, Ndcg: 0.0322 || Avg Loss: 24.4604 | BPR: 0.0258, Prompt: 0.2404, Image: 1.2595, Text: 0.5534, Reg: 0.0005, Feat_Reg: 0.0031, GCL: 0.3857
2024-10-16 14:04: 🎉Best recall: [0.04764, 0.08611, 0.14819, 0.17542], Best ndcg: [0.02302, 0.03260, 0.04517, 0.05009]. Model saved to teacher_model_great.pt
2024-10-16 14:04: 🎓📘Epoch 27/1000 Early stopping 0 - Recall 0.08611, Ndcg: 0.0326 || Avg Loss: 24.5339 | BPR: 0.0239, Prompt: 0.2412, Image: 1.0692, Text: 0.5225, Reg: 0.0005, Feat_Reg: 0.0029, GCL: 0.3857
2024-10-16 14:04: 🎉Best recall: [0.04694, 0.08431, 0.14847, 0.17542], Best ndcg: [0.02296, 0.03229, 0.04532, 0.05018]. Model saved to teacher_model_great.pt
2024-10-16 14:04: 🎓📘Epoch 28/1000 Early stopping 0 - Recall 0.08431, Ndcg: 0.0323 || Avg Loss: 24.3164 | BPR: 0.0224, Prompt: 0.2390, Image: 1.1032, Text: 0.6427, Reg: 0.0006, Feat_Reg: 0.0029, GCL: 0.3843
2024-10-16 14:04: 🎉Best recall: [0.04778, 0.08611, 0.14792, 0.17556], Best ndcg: [0.02333, 0.03285, 0.04540, 0.05040]. Model saved to teacher_model_great.pt
2024-10-16 14:04: 🎓📘Epoch 29/1000 Early stopping 0 - Recall 0.08611, Ndcg: 0.0329 || Avg Loss: 24.3759 | BPR: 0.0213, Prompt: 0.2397, Image: 1.0814, Text: 0.5118, Reg: 0.0006, Feat_Reg: 0.0027, GCL: 0.3837
2024-10-16 14:05: 🎓📘Epoch 30/1000 Early stopping 1 - Recall 0.08389, Ndcg: 0.0322 || Avg Loss: 24.2691 | BPR: 0.0201, Prompt: 0.2386, Image: 1.3212, Text: 0.5249, Reg: 0.0006, Feat_Reg: 0.0027, GCL: 0.3832
2024-10-16 14:05: 🎉Best recall: [0.04819, 0.08639, 0.14861, 0.17347], Best ndcg: [0.02343, 0.03291, 0.04554, 0.05004]. Model saved to teacher_model_great.pt
2024-10-16 14:05: 🎓📘Epoch 31/1000 Early stopping 0 - Recall 0.08639, Ndcg: 0.0329 || Avg Loss: 24.4448 | BPR: 0.0188, Prompt: 0.2404, Image: 1.0569, Text: 0.4980, Reg: 0.0006, Feat_Reg: 0.0025, GCL: 0.3829
2024-10-16 14:05: 🎓📘Epoch 32/1000 Early stopping 1 - Recall 0.08528, Ndcg: 0.0328 || Avg Loss: 24.3201 | BPR: 0.0182, Prompt: 0.2392, Image: 0.9065, Text: 0.5716, Reg: 0.0006, Feat_Reg: 0.0024, GCL: 0.3811
2024-10-16 14:05: 🎓📘Epoch 33/1000 Early stopping 2 - Recall 0.08389, Ndcg: 0.0326 || Avg Loss: 24.4634 | BPR: 0.0173, Prompt: 0.2406, Image: 0.9848, Text: 0.4435, Reg: 0.0006, Feat_Reg: 0.0023, GCL: 0.3819
2024-10-16 14:05: 🎓📘Epoch 34/1000 Early stopping 3 - Recall 0.08514, Ndcg: 0.0329 || Avg Loss: 24.6971 | BPR: 0.0165, Prompt: 0.2430, Image: 0.8980, Text: 0.4671, Reg: 0.0006, Feat_Reg: 0.0022, GCL: 0.3803
2024-10-16 14:06: 🎓📘Epoch 35/1000 Early stopping 4 - Recall 0.08486, Ndcg: 0.0326 || Avg Loss: 24.4632 | BPR: 0.0156, Prompt: 0.2406, Image: 0.9081, Text: 0.5213, Reg: 0.0006, Feat_Reg: 0.0022, GCL: 0.3809
2024-10-16 14:06: 🎓📘Epoch 36/1000 Early stopping 5 - Recall 0.08472, Ndcg: 0.0326 || Avg Loss: 24.3647 | BPR: 0.0150, Prompt: 0.2396, Image: 0.8651, Text: 0.4557, Reg: 0.0006, Feat_Reg: 0.0021, GCL: 0.3815
2024-10-16 14:06: 🎓📘Epoch 37/1000 Early stopping 6 - Recall 0.08333, Ndcg: 0.0321 || Avg Loss: 24.3132 | BPR: 0.0147, Prompt: 0.2391, Image: 0.7684, Text: 0.5878, Reg: 0.0007, Feat_Reg: 0.0021, GCL: 0.3797
2024-10-16 14:06: 🎓📘Epoch 38/1000 Early stopping 7 - Recall 0.08417, Ndcg: 0.0325 || Avg Loss: 24.3410 | BPR: 0.0140, Prompt: 0.2394, Image: 0.8905, Text: 0.6400, Reg: 0.0007, Feat_Reg: 0.0021, GCL: 0.3789
2024-10-16 14:06: early stopping at epoch 39
2024-10-16 14:06: 🏆🎉Final model saved to /home/ZIYIAP/Documents/OneDrive_local/distiller/TARec/TARec/Model/teacher/tiktok/teacher_model_final.pt, best epoch: 31, best recall: [0.04819, 0.08639, 0.14861, 0.17347], best ndcg: [0.02343, 0.03291, 0.04554, 0.05004]
2024-10-16 14:06: ⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛
2024-10-16 14:06: ✅🎓📘 Finished training teacher model... 🏆🎉
2024-10-16 14:06: ⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛
