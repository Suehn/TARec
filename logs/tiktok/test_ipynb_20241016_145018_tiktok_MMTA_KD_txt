2024-10-16 14:50: PID: 54868

2024-10-16 14:50: args: 
name                              : MMTA_KD
dataset                           : tiktok
data_path                         : /home/ZIYIAP/Documents/OneDrive_local/distiller/TARec/TARec/data
Ks                                : [10, 20, 40, 50]
seed                              : 14322
sparse                            : 1
test_flag                         : part
edge_mask                         : 0
edge_mask_rate                    : 0.1
batch_size                        : 1024
epoch                             : 1000
cf_model                          : light_init
early_stopping_patience           : 8
gpu_id                            : 0
regs                              : [1e-5,1e-5,1e-2]
emb_reg                           : 1e-07
teacher_model_type                : gcl
lr                                : 0.001
teacher_model_dict_name           : teacher_model_great
teacher_reg_rate                  : 1
t_weight_decay                    : 0.001
t_feat_mf_rate                    : 0.001
feat_reg_decay                    : 1e-05
is_softmax                        : True
is_gcl_softmax                    : False
teacher_assistant_model_type      : lightgcl
teacher_assistant_model_dict_name : teacher_assistant_model_great
student_model_type                : mlpgcl
student_model_dict_name           : 
student_embed_size                : 64
student_lr                        : 0.001
student_reg_rate                  : 1
student_drop_rate                 : 0.2
student_tau                       : 5
embed_size                        : 64
drop_rate                         : 0.4
weight_size                       : [64, 64]
model_cat_rate                    : 0.028
layers                            : 1
n_layers                          : 2
ta_n_layers                       : 1
student_n_layers                  : 1
mlp_n_layers                      : 1
if_train_teacher                  : True
is_train_student                  : False
kd_loss_rate                      : 5e-06
kd_loss_feat_rate                 : 0.1
cl_loss_rate                      : 0.002
svd_gcl_rate                      : 1.0
x_gcl_rate                        : 1.0
layer_gcl                         : 1.0
svd_layer_gcl                     : 0.0
xsvd_gcl                          : 0.0
x_layer_gcl                       : 0.0
ssm_rate                          : 0.6
s_layer_gcl                       : 0.0025
t_cl_loss_rate                    : 0.01
hard_token_type                   : pca
soft_token_rate                   : 0.1
feat_soft_token_rate              : 9
t_prompt_rate1                    : 100.0
prompt_dropout                    : 0
alpha_l                           : 2
feat_loss_type                    : sce
neg_sample_num                    : 10
list_wise_loss_rate               : 1
q                                 : 1
eps                               : 0.2
kd_t_decay_threshold              : 0.0
kd_ta_decay_rate                  : 0.6
kd_t_decay_rate                   : 0.6
t_init_method                     : uniform
norm_mode                         : None
ta_norm_mode                      : None
s_norm_mode                       : None
s_norm_scale                      : 0.05
ta_norm_scale                     : 0.0
norm_scale                        : 0.08
kd_loss_type                      : sinkhorn
is_teacher_kd                     : False
init_teacher                      : False
t_bpr_loss_rate                   : 1.0
2024-10-16 14:50: 🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸
2024-10-16 14:50: 🎓📘 Start training teacher model... 🚀✨
2024-10-16 14:50: Teacher model type: gcl
2024-10-16 14:50: 🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸🔸

2024-10-16 14:50: 🎓📘Epoch 1/1000 Early stopping 0 - Recall 0.05319, Ndcg: 0.0205 || Avg Loss: 38.7783 | BPR: 0.6599, Prompt: 0.3750, Image: 76.6678, Text: 7.5243, Reg: 0.0000, Feat_Reg: 0.0447, GCL: 0.4929
2024-10-16 14:50: 🎓📘Epoch 2/1000 Early stopping 0 - Recall 0.04208, Ndcg: 0.0160 || Avg Loss: 27.4546 | BPR: 0.5672, Prompt: 0.2642, Image: 4.6054, Text: 0.4595, Reg: 0.0000, Feat_Reg: 0.0104, GCL: 0.4531
2024-10-16 14:50: 🎓📘Epoch 3/1000 Early stopping 0 - Recall 0.04444, Ndcg: 0.0168 || Avg Loss: 25.7258 | BPR: 0.3893, Prompt: 0.2486, Image: 3.3677, Text: 0.8057, Reg: 0.0001, Feat_Reg: 0.0092, GCL: 0.4632
2024-10-16 14:50: 🎓📘Epoch 4/1000 Early stopping 0 - Recall 0.05083, Ndcg: 0.0190 || Avg Loss: 25.0985 | BPR: 0.2836, Prompt: 0.2435, Image: 2.7243, Text: 1.0254, Reg: 0.0001, Feat_Reg: 0.0084, GCL: 0.4565
2024-10-16 14:51: 🎓📘Epoch 5/1000 Early stopping 0 - Recall 0.05708, Ndcg: 0.0212 || Avg Loss: 24.8573 | BPR: 0.2261, Prompt: 0.2417, Image: 2.6467, Text: 0.9074, Reg: 0.0002, Feat_Reg: 0.0078, GCL: 0.4459
2024-10-16 14:51: 🎓📘Epoch 6/1000 Early stopping 0 - Recall 0.06264, Ndcg: 0.0232 || Avg Loss: 24.6785 | BPR: 0.1866, Prompt: 0.2404, Image: 2.4126, Text: 0.9722, Reg: 0.0002, Feat_Reg: 0.0073, GCL: 0.4384
2024-10-16 14:51: 🎓📘Epoch 7/1000 Early stopping 0 - Recall 0.06847, Ndcg: 0.0249 || Avg Loss: 24.5963 | BPR: 0.1589, Prompt: 0.2400, Image: 2.4477, Text: 1.0734, Reg: 0.0002, Feat_Reg: 0.0070, GCL: 0.4305
2024-10-16 14:51: 🎓📘Epoch 8/1000 Early stopping 0 - Recall 0.07042, Ndcg: 0.0260 || Avg Loss: 24.5749 | BPR: 0.1368, Prompt: 0.2400, Image: 2.1986, Text: 1.0600, Reg: 0.0002, Feat_Reg: 0.0067, GCL: 0.4247
2024-10-16 14:51: 🎉Best recall: [0.03792, 0.07278, 0.12389, 0.15167], Best ndcg: [0.01799, 0.02670, 0.03710, 0.04211]. Model saved to teacher_model_great.pt
2024-10-16 14:51: 🎓📘Epoch 9/1000 Early stopping 0 - Recall 0.07278, Ndcg: 0.0267 || Avg Loss: 24.6553 | BPR: 0.1201, Prompt: 0.2410, Image: 2.1829, Text: 1.2182, Reg: 0.0003, Feat_Reg: 0.0064, GCL: 0.4209
2024-10-16 14:51: 🎉Best recall: [0.03931, 0.07458, 0.12736, 0.15361], Best ndcg: [0.01859, 0.02736, 0.03808, 0.04284]. Model saved to teacher_model_great.pt
2024-10-16 14:51: 🎓📘Epoch 10/1000 Early stopping 0 - Recall 0.07458, Ndcg: 0.0274 || Avg Loss: 24.5693 | BPR: 0.1055, Prompt: 0.2404, Image: 2.3156, Text: 1.0887, Reg: 0.0003, Feat_Reg: 0.0063, GCL: 0.4158
2024-10-16 14:51: 🎉Best recall: [0.03931, 0.07556, 0.12889, 0.15611], Best ndcg: [0.01868, 0.02776, 0.03862, 0.04355]. Model saved to teacher_model_great.pt
2024-10-16 14:51: 🎓📘Epoch 11/1000 Early stopping 0 - Recall 0.07556, Ndcg: 0.0278 || Avg Loss: 24.5445 | BPR: 0.0935, Prompt: 0.2403, Image: 1.9892, Text: 0.8281, Reg: 0.0003, Feat_Reg: 0.0057, GCL: 0.4119
2024-10-16 14:51: 🎉Best recall: [0.04014, 0.07736, 0.13042, 0.16028], Best ndcg: [0.01909, 0.02839, 0.03918, 0.04457]. Model saved to teacher_model_great.pt
2024-10-16 14:51: 🎓📘Epoch 12/1000 Early stopping 0 - Recall 0.07736, Ndcg: 0.0284 || Avg Loss: 24.5969 | BPR: 0.0840, Prompt: 0.2409, Image: 2.3376, Text: 0.8384, Reg: 0.0003, Feat_Reg: 0.0058, GCL: 0.4087
2024-10-16 14:52: 🎉Best recall: [0.04125, 0.07889, 0.13500, 0.16056], Best ndcg: [0.01981, 0.02918, 0.04056, 0.04517]. Model saved to teacher_model_great.pt
2024-10-16 14:52: 🎓📘Epoch 13/1000 Early stopping 0 - Recall 0.07889, Ndcg: 0.0292 || Avg Loss: 24.4348 | BPR: 0.0753, Prompt: 0.2395, Image: 1.8420, Text: 0.6598, Reg: 0.0003, Feat_Reg: 0.0052, GCL: 0.4063
2024-10-16 14:52: 🎉Best recall: [0.04097, 0.07986, 0.13583, 0.16375], Best ndcg: [0.01967, 0.02938, 0.04075, 0.04579]. Model saved to teacher_model_great.pt
2024-10-16 14:52: 🎓📘Epoch 14/1000 Early stopping 0 - Recall 0.07986, Ndcg: 0.0294 || Avg Loss: 24.5443 | BPR: 0.0688, Prompt: 0.2406, Image: 1.9743, Text: 0.7252, Reg: 0.0004, Feat_Reg: 0.0051, GCL: 0.4042
2024-10-16 14:52: 🎉Best recall: [0.03972, 0.07917, 0.13806, 0.16569], Best ndcg: [0.01917, 0.02907, 0.04104, 0.04603]. Model saved to teacher_model_great.pt
2024-10-16 14:52: 🎓📘Epoch 15/1000 Early stopping 0 - Recall 0.07917, Ndcg: 0.0291 || Avg Loss: 24.3849 | BPR: 0.0626, Prompt: 0.2391, Image: 1.9121, Text: 0.5029, Reg: 0.0004, Feat_Reg: 0.0048, GCL: 0.4013
2024-10-16 14:52: 🎉Best recall: [0.04208, 0.08028, 0.13903, 0.16792], Best ndcg: [0.02003, 0.02963, 0.04160, 0.04682]. Model saved to teacher_model_great.pt
2024-10-16 14:52: 🎓📘Epoch 16/1000 Early stopping 0 - Recall 0.08028, Ndcg: 0.0296 || Avg Loss: 24.3259 | BPR: 0.0559, Prompt: 0.2386, Image: 1.7169, Text: 0.4207, Reg: 0.0004, Feat_Reg: 0.0045, GCL: 0.3982
2024-10-16 14:52: 🎉Best recall: [0.04250, 0.08097, 0.14139, 0.16847], Best ndcg: [0.02010, 0.02976, 0.04202, 0.04690]. Model saved to teacher_model_great.pt
2024-10-16 14:52: 🎓📘Epoch 17/1000 Early stopping 0 - Recall 0.08097, Ndcg: 0.0298 || Avg Loss: 24.5406 | BPR: 0.0513, Prompt: 0.2409, Image: 1.5344, Text: 0.4269, Reg: 0.0004, Feat_Reg: 0.0042, GCL: 0.3973
2024-10-16 14:52: 🎉Best recall: [0.04306, 0.08181, 0.14347, 0.16958], Best ndcg: [0.02044, 0.03018, 0.04270, 0.04743]. Model saved to teacher_model_great.pt
2024-10-16 14:52: 🎓📘Epoch 18/1000 Early stopping 0 - Recall 0.08181, Ndcg: 0.0302 || Avg Loss: 24.3670 | BPR: 0.0469, Prompt: 0.2392, Image: 1.5392, Text: 0.4524, Reg: 0.0004, Feat_Reg: 0.0040, GCL: 0.3949
2024-10-16 14:52: 🎉Best recall: [0.04333, 0.08264, 0.14375, 0.17069], Best ndcg: [0.02070, 0.03058, 0.04297, 0.04784]. Model saved to teacher_model_great.pt
2024-10-16 14:52: 🎓📘Epoch 19/1000 Early stopping 0 - Recall 0.08264, Ndcg: 0.0306 || Avg Loss: 24.4964 | BPR: 0.0427, Prompt: 0.2405, Image: 1.5787, Text: 0.5061, Reg: 0.0004, Feat_Reg: 0.0040, GCL: 0.3936
2024-10-16 14:52: 🎉Best recall: [0.04458, 0.08389, 0.14389, 0.17125], Best ndcg: [0.02128, 0.03112, 0.04332, 0.04827]. Model saved to teacher_model_great.pt
2024-10-16 14:52: 🎓📘Epoch 20/1000 Early stopping 0 - Recall 0.08389, Ndcg: 0.0311 || Avg Loss: 24.6975 | BPR: 0.0393, Prompt: 0.2426, Image: 1.5482, Text: 0.4237, Reg: 0.0005, Feat_Reg: 0.0039, GCL: 0.3934
2024-10-16 14:53: 🎉Best recall: [0.04361, 0.08361, 0.14611, 0.17167], Best ndcg: [0.02104, 0.03109, 0.04378, 0.04840]. Model saved to teacher_model_great.pt
2024-10-16 14:53: 🎓📘Epoch 21/1000 Early stopping 0 - Recall 0.08361, Ndcg: 0.0311 || Avg Loss: 24.4398 | BPR: 0.0365, Prompt: 0.2401, Image: 1.4291, Text: 0.5418, Reg: 0.0005, Feat_Reg: 0.0037, GCL: 0.3914
2024-10-16 14:53: 🎓📘Epoch 22/1000 Early stopping 1 - Recall 0.08292, Ndcg: 0.0310 || Avg Loss: 24.4035 | BPR: 0.0333, Prompt: 0.2397, Image: 1.3180, Text: 0.4363, Reg: 0.0005, Feat_Reg: 0.0035, GCL: 0.3901
2024-10-16 14:53: 🎉Best recall: [0.04333, 0.08417, 0.14625, 0.17236], Best ndcg: [0.02124, 0.03148, 0.04408, 0.04881]. Model saved to teacher_model_great.pt
2024-10-16 14:53: 🎓📘Epoch 23/1000 Early stopping 0 - Recall 0.08417, Ndcg: 0.0315 || Avg Loss: 24.3292 | BPR: 0.0314, Prompt: 0.2390, Image: 1.2452, Text: 0.5483, Reg: 0.0005, Feat_Reg: 0.0034, GCL: 0.3893
2024-10-16 14:53: 🎓📘Epoch 24/1000 Early stopping 1 - Recall 0.08306, Ndcg: 0.0312 || Avg Loss: 24.3644 | BPR: 0.0294, Prompt: 0.2394, Image: 1.4334, Text: 0.4859, Reg: 0.0005, Feat_Reg: 0.0034, GCL: 0.3871
2024-10-16 14:53: 🎉Best recall: [0.04472, 0.08347, 0.14556, 0.17319], Best ndcg: [0.02178, 0.03152, 0.04414, 0.04914]. Model saved to teacher_model_great.pt
2024-10-16 14:53: 🎓📘Epoch 25/1000 Early stopping 0 - Recall 0.08347, Ndcg: 0.0315 || Avg Loss: 24.3571 | BPR: 0.0275, Prompt: 0.2394, Image: 1.2184, Text: 0.5078, Reg: 0.0005, Feat_Reg: 0.0032, GCL: 0.3868
2024-10-16 14:53: 🎓📘Epoch 26/1000 Early stopping 1 - Recall 0.08236, Ndcg: 0.0312 || Avg Loss: 24.4607 | BPR: 0.0260, Prompt: 0.2404, Image: 1.1241, Text: 0.5853, Reg: 0.0005, Feat_Reg: 0.0030, GCL: 0.3858
2024-10-16 14:53: 🎉Best recall: [0.04542, 0.08417, 0.14556, 0.17333], Best ndcg: [0.02215, 0.03187, 0.04435, 0.04937]. Model saved to teacher_model_great.pt
2024-10-16 14:53: 🎓📘Epoch 27/1000 Early stopping 0 - Recall 0.08417, Ndcg: 0.0319 || Avg Loss: 24.5335 | BPR: 0.0241, Prompt: 0.2412, Image: 1.0388, Text: 0.5104, Reg: 0.0005, Feat_Reg: 0.0028, GCL: 0.3852
2024-10-16 14:54: 🎉Best recall: [0.04583, 0.08292, 0.14611, 0.17333], Best ndcg: [0.02234, 0.03165, 0.04451, 0.04943]. Model saved to teacher_model_great.pt
2024-10-16 14:54: 🎓📘Epoch 28/1000 Early stopping 0 - Recall 0.08292, Ndcg: 0.0317 || Avg Loss: 24.3158 | BPR: 0.0225, Prompt: 0.2390, Image: 1.1476, Text: 0.6079, Reg: 0.0006, Feat_Reg: 0.0029, GCL: 0.3836
2024-10-16 14:54: 🎉Best recall: [0.04667, 0.08403, 0.14611, 0.17375], Best ndcg: [0.02259, 0.03192, 0.04457, 0.04956]. Model saved to teacher_model_great.pt
2024-10-16 14:54: 🎓📘Epoch 29/1000 Early stopping 0 - Recall 0.08403, Ndcg: 0.0319 || Avg Loss: 24.3766 | BPR: 0.0215, Prompt: 0.2397, Image: 1.0820, Text: 0.5016, Reg: 0.0006, Feat_Reg: 0.0027, GCL: 0.3841
2024-10-16 14:54: 🎓📘Epoch 30/1000 Early stopping 1 - Recall 0.08264, Ndcg: 0.0315 || Avg Loss: 24.2684 | BPR: 0.0202, Prompt: 0.2386, Image: 1.2367, Text: 0.5307, Reg: 0.0006, Feat_Reg: 0.0027, GCL: 0.3827
2024-10-16 14:54: 🎓📘Epoch 31/1000 Early stopping 2 - Recall 0.08347, Ndcg: 0.0318 || Avg Loss: 24.4444 | BPR: 0.0189, Prompt: 0.2404, Image: 1.0405, Text: 0.4920, Reg: 0.0006, Feat_Reg: 0.0025, GCL: 0.3825
2024-10-16 14:54: 🎓📘Epoch 32/1000 Early stopping 3 - Recall 0.08361, Ndcg: 0.0319 || Avg Loss: 24.3207 | BPR: 0.0183, Prompt: 0.2392, Image: 0.9106, Text: 0.6076, Reg: 0.0006, Feat_Reg: 0.0025, GCL: 0.3817
2024-10-16 14:54: 🎓📘Epoch 33/1000 Early stopping 4 - Recall 0.08292, Ndcg: 0.0318 || Avg Loss: 24.4634 | BPR: 0.0173, Prompt: 0.2406, Image: 1.0786, Text: 0.4187, Reg: 0.0006, Feat_Reg: 0.0024, GCL: 0.3815
2024-10-16 14:54: 🎉Best recall: [0.04722, 0.08319, 0.14722, 0.17069], Best ndcg: [0.02297, 0.03194, 0.04496, 0.04922]. Model saved to teacher_model_great.pt
2024-10-16 14:54: 🎓📘Epoch 34/1000 Early stopping 0 - Recall 0.08319, Ndcg: 0.0319 || Avg Loss: 24.6970 | BPR: 0.0166, Prompt: 0.2430, Image: 0.8527, Text: 0.4640, Reg: 0.0006, Feat_Reg: 0.0022, GCL: 0.3802
2024-10-16 14:54: 🎓📘Epoch 35/1000 Early stopping 1 - Recall 0.08250, Ndcg: 0.0315 || Avg Loss: 24.4623 | BPR: 0.0156, Prompt: 0.2406, Image: 0.8969, Text: 0.5296, Reg: 0.0006, Feat_Reg: 0.0022, GCL: 0.3801
2024-10-16 14:55: 🎓📘Epoch 36/1000 Early stopping 2 - Recall 0.08403, Ndcg: 0.0319 || Avg Loss: 24.3636 | BPR: 0.0151, Prompt: 0.2396, Image: 0.8954, Text: 0.4720, Reg: 0.0006, Feat_Reg: 0.0021, GCL: 0.3801
2024-10-16 14:55: 🎓📘Epoch 37/1000 Early stopping 3 - Recall 0.08208, Ndcg: 0.0313 || Avg Loss: 24.3132 | BPR: 0.0148, Prompt: 0.2391, Image: 0.8140, Text: 0.6451, Reg: 0.0007, Feat_Reg: 0.0021, GCL: 0.3794
2024-10-16 14:55: 🎓📘Epoch 38/1000 Early stopping 4 - Recall 0.08292, Ndcg: 0.0315 || Avg Loss: 24.3422 | BPR: 0.0141, Prompt: 0.2394, Image: 0.8578, Text: 0.6290, Reg: 0.0007, Feat_Reg: 0.0021, GCL: 0.3801
2024-10-16 14:55: 🎓📘Epoch 39/1000 Early stopping 5 - Recall 0.08222, Ndcg: 0.0311 || Avg Loss: 24.5689 | BPR: 0.0134, Prompt: 0.2417, Image: 0.9815, Text: 0.4760, Reg: 0.0007, Feat_Reg: 0.0020, GCL: 0.3784
2024-10-16 14:55: 🎓📘Epoch 40/1000 Early stopping 6 - Recall 0.08208, Ndcg: 0.0312 || Avg Loss: 24.4571 | BPR: 0.0137, Prompt: 0.2406, Image: 0.8761, Text: 0.6237, Reg: 0.0007, Feat_Reg: 0.0020, GCL: 0.3780
2024-10-16 14:55: 🎓📘Epoch 41/1000 Early stopping 7 - Recall 0.08083, Ndcg: 0.0305 || Avg Loss: 24.4661 | BPR: 0.0122, Prompt: 0.2407, Image: 0.7618, Text: 0.4505, Reg: 0.0007, Feat_Reg: 0.0018, GCL: 0.3790
2024-10-16 14:55: early stopping at epoch 42
2024-10-16 14:55: 🏆🎉Final model saved to /home/ZIYIAP/Documents/OneDrive_local/distiller/TARec/TARec/Model/teacher/tiktok/teacher_model_final.pt, best epoch: 34, best recall: [0.04722, 0.08319, 0.14722, 0.17069], best ndcg: [0.02297, 0.03194, 0.04496, 0.04922]
2024-10-16 14:55: ⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛
2024-10-16 14:55: ✅🎓📘 Finished training teacher model... 🏆🎉
2024-10-16 14:55: ⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛
